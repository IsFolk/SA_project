<!DOCTYPE html>
<html>
	<head>
		<title>OWL MY CLASS</title>
		<meta charset="utf-8">
		<base href="">
		<link rel="icon" type="image/png" href="">
		<link href="" type="text/css" rel="stylesheet">
		<link href="../../../css_files/general.css" type="text/css" rel="stylesheet">
		<link href="../css_files/test.css" type="text/css" rel="stylesheet">
	</head>
	<body>
		<!--畫面最上方的橫條navbar-->
		<nav>
			<div class="container">
				<div class="navbar-header">
					<img src="" alt="logo">
					<span class="text">OWL MY CLASS</span>
				</div>
				<div class="navbar-collapse">
					<ul class="navbar-right">
						<li>
							<div class="homebtn">
								<a href="#"><span class="text">我的主頁</span></a>
							</div>
						</li>
						<li class="dropdown-btn">
							<a href="#" tabindex="0"><img src="" alt="img"></a>
							<ul class="dropdown-menu">
								<li>
									<a href="#"><span class="text">個人資訊</span></a>
								</li>
								<li>
									<a href="#"><span class="text">登出</span></a>		
								</li>
							</ul>
						</li>
					</ul>
				</div>
			</div>
		</nav>

		<!--橫幅-->
		<div class="banner">
			<div class="container">
				<img src="" alt="img">
					<span class="banner-name course-name text-bold"></span>
					<span class="banner-extInfo course-code"></span>
			</div>
		</div>

		<!--下半部分-->
		<div class="lowerhalf">
			<div class="container">
				<!--左下的選單-->
				<div class="sidebar">
					<div class="professor">
						<span class="text-bold">教授:</span><span class="text-bold course-professor"></span>
					</div>
					<ul class="sidebar-menu">
						<li>
							<a href="../info/info.html" class="sidebar_link"><span class="text">課程資訊</span></a>
						</li>
						<li>
							<a href="../board/board.html" class="sidebar_link"><span class="text">課程公告</span></a>
						</li>
						<li>
							<a href="../textbook/textbookList.html" class="sidebar_link"><span class="text">課程教材</span></a>
						</li>
						<li>
							<a href="../homework/homeworkList.html" class="sidebar_link"><span class="text">作業</span></a>
						</li>
						<li class="currentpage">
							<a href="testList.html" class="sidebar_link"><span class="text">測驗</span></a>
						</li>
					</ul>
				</div>
				<!--右下區域-->
				<div class="content-right">
					<div class="content-right-title">
						<span class="text-bold test-name"></span>
					</div>
					<div class="hr"></div>
					<a href="addTestInfo.html"><span class="text go-edit-btn pro-only">修改測驗</span></a>
					<table class="info-tbl">
						<tbody>
							<tr>
								<td class="tr-title">開放時間</td>
								<td><span class="start-time"></span>~<span class="end-time"></span></td>
							</tr>
							<tr>
								<td class="tr-title">說明</td>
								<td class="test-detail"></td>
							</tr>
						</tbody>
					</table>
					<br><br><br>
					<a href="studentTestAns.html" id="check_ans_btn"><span class="text test-goto-btn see-result stu-only">查看作答結果</span></a>
					<a href="answeringTest.html" id="start_test_btn"><span class="text test-goto-btn start-test stu-only">開始測驗</span></a>
					<a href="studentTestAnsList.html" id="stu_anslist_btn"><span class="text test-goto-btn pro-only">查看學生作答結果</span></a>
				</div>
			</div>
		</div>
		
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
		<script src="../../../js_files/general.js"></script>
		<script>
///////////////////從URL接收參數///////////////////////////
function getValue(varname)
{
  var url = window.location.href;
  var qparts = url.split("?");
  if (qparts.length == 0){return "";}
  var query = qparts[1];
  var vars = query.split("&amp;");
  var value = "";
  for (i=0; i<vars.length; i++)
  {
    var parts = vars[i].split("=");
    if (parts[0] == varname)
    {
      value = parts[1];
      break;
    }
  }
  value = unescape(value);
  value.replace(/\+/g," ");
  return value;
}
var courseid = getValue("courseid");
var userid = getValue("userid");
var testid = getValue("testid");
////////////////把資料塞進table//////////////
$.ajax({
	type: "GET",
	url: "api/Test.do",
	data: "id=" + id,
	crossDomain: true,
	cache: false,
	dataType: 'json',
	timeout: 5000,
	success: function (response) {
		if(response.status == 200){
		  updateHTML(response.response.data);
		}
	},
  error: function () {
	  alert("無法連線到伺服器！");
  }
});

function updateHTML(data){
	str = data['name'];
	$(".test-name").text(str);
	str = data['opening_time'];
	$(".start-time").text(str);
	str = data['end_time'];
	$(".end-time").text(str);
	str = data['detail'];
	$(".test-detail").text(str);
}

/////////////////////////////////////////////

//////////////作答前/作答後////////////////////
var test_finished = 0;
if(test_finished){
	$(".start-test").remove();
}else{
	$(".see-result").remove();
}
//////////////在URL後加上參數///////////
let sidebar_url = '?courseId='+'';
let btn_url = '&testid=' + testid;
appendURL('.sidebar_link', '');
$('#check_ans_btn').attr('href', $('#check_ans_btn').attr('href')+btn_url);
$('#start_test_btn').attr('href', $('#start_test_btn').attr('href')+btn_url);
$('#stu_anslist_btn').attr('href', $('#stu_anslist_btn').attr('href')+btn_url);

//////////////在url後加字串/////////
function appendURL(selector, str){
	$(selector).attr('href', $(selector).attr('href')+str);
}

		</script>
	</body>
</html>
