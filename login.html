<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>CakePHP: the rapid development php framework: Managers</title>
    <link href="statics/icon/favicon.ico" type="image/x-icon" rel="icon">
    <link href="statics/icon/favicon.ico" type="image/x-icon" rel="shortcut icon">
    <link rel="stylesheet" type="text/css" href="statics/css/cake.generic.css">

    <script src="statics/js/jquery-3.4.1.min.js" crossorigin="anonymous"></script>
</head>
<body>
	<div id="flashMessage" class="message" style="display: none;"></div>
		<select id = "user_type">
	    	<option>選擇類別</option>
	    	<option>系統管理者</option>
	    	<option>學生</option>
	    	<option>教授</option>
		</select>
		<br>
		ID<input id="id" type="text"/> <br>
		password<input id="password" type="text"/> <br>
		<input type="submit" id = "submit"/>
</body>

            <script type="text/javascript">
            
                $(document).ready(function() {
                    // 處理表單點擊事件
                    var $form = $('#submit');
                    
                    $form.click(function() {
                        submit();
                    })
                });

                    function submit() {
                    	var user_type = $('#user_type').val();
                        var id = $('#id').val();
                        var password= $('#password').val();
                        console.log(user_type+id+password);


							if(user_type == "系統管理者"){
								var data_object = {
										"ManagerId" : id,
										"Password": password
								};							
								
							}else if(user_type == "教授"){
								var data_object = {
										"ProfessorId" : id,
										"Password": password
								};							
							}
						
						console.log(data_object);

                            // 將JSON格式轉換成字串
                            var data_string = JSON.stringify(data_object);

                            // 發出POST的AJAX請求
                            $.ajax({
                                    type: "POST",
                                    url: "api/LoginController",
                                    data: data_string,
                                    crossDomain: true,
                                    cache: false,
                                    dataType: 'json',
                                    timeout: 5000,
                                    success: function (response) {
                                        //$('#flashMessage').html(response.message);
                                        //$('#flashMessage').show();
                                        alert("success");
                                        console.log(response);
                                        
                                        if(response.status == 200){
                                            //updateSQLTable(response.response);
                                            
                                            console.log("success");
                                        	window.location.href = "index.html";
                                    	
                                        }
                                    },
                                    error: function () {
                                        alert("無法連線到伺服器！");
                                    }
                            });
                        }
            </script>
</html>