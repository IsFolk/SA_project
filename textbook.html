<!DOCTYPE html>
<html>
	<head>
		<title>OWL MY CLASS</title>
		<meta charset="utf-8">
		<base href="">
		<link rel="icon" type="image/png" href="">
		<link href="" type="text/css" rel="stylesheet">
		<link href="css_files/general.css" type="text/css" rel="stylesheet">
		<link href="css_files/.css" type="text/css" rel="stylesheet">
	</head>
	<body>
		<!--畫面最上方的橫條navbar-->
		<nav>
			<div class="container">
				<div class="navbar-header">
					<img src="" alt="logo">
					<span class="text">OWL MY CLASS</span>
				</div>
				<div class="navbar-collapse">
					<ul class="navbar-right">
						<li>
							<div class="homebtn">
								<a href="#"><span class="text">我的主頁</span></a>
							</div>
						</li>
						<li class="dropdown-btn">
							<a href="#" tabindex="0"><img src="" alt="img"></a>
							<ul class="dropdown-menu">
								<li>
									<a href="#"><span class="text">個人資訊</span></a>
								</li>
								<li>
									<a href="#"><span class="text">登出</span></a>		
								</li>
							</ul>
						</li>
					</ul>
				</div>
			</div>
		</nav>

		<!--橫幅-->
		<div class="banner">
			<div class="container">
				<img src="" alt="img">
					<span class="banner-name course-name text-bold"></span>
					<span class="banner-extInfo course-code"></span>
			</div>
		</div>

		<!--下半部分-->
		<div class="lowerhalf">
			<div class="container">
				<!--左下的選單-->
				<div class="sidebar">
					<div class="professor">
						<span class="text-bold">教授:</span><span class="text-bold course-professor"></span>
					</div>
					<ul class="sidebar-menu">
						<li>
							<a href="../info/info.html"><span class="text">課程資訊</span></a>
						</li>
						<li>
							<a href="../board/board.html"><span class="text">課程公告</span></a>
						</li>
						<li class="currentpage">
							<a href="textbookList.html"><span class="text">課程教材</span></a>
						</li>
						<li>
							<a href="../homework/homeworkList.html"><span class="text">作業</span></a>
						</li>
						<li>
							<a href="../test/testList.html"><span class="text">測驗</span></a>
						</li>
					</ul>
				</div>
				<!--右下區域-->
				<div class="content-right">
					<div class="content-right-title">
						<span class="text-bold textbook-name"></span>
					</div>
					<div class="hr"></div>
					<a href="editTextbook.html"><span class="text go-edit-btn pro-only">修改教材</span></a>
					<table class="info-tbl">
						<tbody>
							<tr>
								<td class="tr-title">說明</td>
								<td class="textbook-detail break-word"></td>
							</tr>
							<tr>
								<td class="tr-title">附件</td>
								<td><div class="textbook-attachmentName"></div></td>
							</tr>
						</tbody>
					</table>
					<br><br><br>
					<a id= "download" href="#" download><span class="text download-btn round-border">下載附件</span></a>
				</div>
			</div>
		</div>
		
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
		<script src="js_files/general.js"></script>
		<script>
		var url_string = window.location.href;                
		var url = new URL(url_string);
		console.log(url);
		var textbookid = url.searchParams.get("TextbookId");
		
		
		function getTextbook(){
		    $.ajax({
		        type: "GET",
		        url: "api/TextbookController",
		        crossDomain: true,
		        cache: false,
		        data: "TextbookId=" + textbookid,
		        dataType: 'json',
		        timeout: 5000,
				// url可能是'../../../../Homework.ashx?Method=GetModuleInfo'之類的 額...可能
				//需要的資訊：這堂課的 HwName, HwEndingTime, HwScore
		                           success: function (response) {
		                                if(response.status == 200){
		                                  		
		                                      	$.each(response.response.data, function (){ 
		                                      		setTextbook(this);
		                                      	})
		                                }
		                            },
		                            error: function () {
		                                alert("無法連線到伺服器！");
		                            }
		    });
		};		
		
	    function setTextbook(data) {
	    	console.log(data.TextbookName);
	    	
	    	$(".textbook-name").text(data.TextbookName);

	    	$(".textbook-detail").text(data.TextbookDetail);
	    	$(".textbook-attachmentName").text(data.Attachment);
	    	
	    	document.getElementById("download").href = "statics/attachment/textbook/" + data.Attachment;
	    	console.log(data);	    	
	    }
	    
	    getTextbook();
		////////////////把資料塞進table//////////////
		</script>
	</body>
</html>