<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>CodePen - 登入頁面</title>
  <link rel="stylesheet" href="css_files/style.css">
  <script src="statics/js/jquery-3.4.1.min.js" crossorigin="anonymous"></script>
</head>
<body>
<!-- partial:index.partial.html -->
<!--LOGIN -->
<?php
$account = isset($_POST['account'] ? $_POST['account'] : '');
$password = isset($_POST['password'] ? $_POST['password'] : '');
?>
<div class="item-center">
  <img class="fs-infobox-logo" src="" alt="logo">
</div>
<div class="fs-infobox-panel" style="width:550px; height:400px;">
    <form id="login_form" action="" method="POST">
      <div class="content-title">
        <span class="text-bold">您好，歡迎</span><br>
      </div>
    <div id="radio-container" style="margin: 20px">
      <label><input type="radio" name="login-type" value="老師"><span class="round button">老師</span></label>
      <label><input type="radio" name="login-type" value="學生"><span class="round button">學生</span></label>
    </div>

      <!--
<lable><input type="radio" name="teacher"><span class="loginbtn">老師</span></lable>
      -->
      帳號<input id="account" name="account" type="text" placeholder="輸入帳號"><br>
      密碼<input id="password" name="password" type="password" placeholder="輸入密碼"><br>
      <button id = "submit" type="button" class="loginbtn" data-role="form-submit">登入</button>
      <p id="forget">忘記密碼？</p>
</div>
<!-- partial -->
  <script  src="js_files/script.js"></script>
  <script>
  
  
  $(document).ready(function() {
      // 處理表單點擊事件
      var $form = $('#submit');
      
      $form.click(function() {
          submit();
      })
  });

      function submit() {
      	var user_type = $('input[name=login-type]:checked', '#radio-container').val();
          var id = $('#account').val();
          var password= $('#password').val();
          console.log(user_type+id+password);


				if(user_type == "學生"){
					var data_object = {
							"StudentId" : id,
							"Password": password
					};							
					
				}else if(user_type == "老師"){
					var data_object = {
							"ProfessorId" : id,
							"Password": password
					};							
				}
			
			console.log(data_object);

              // 將JSON格式轉換成字串
              var data_string = JSON.stringify(data_object);

              // 發出POST的AJAX請求
              $.ajax({
                      type: "POST",
                      url: "api/LoginController",
                      data: data_string,
                      crossDomain: true,
                      cache: false,
                      dataType: 'json',
                      timeout: 5000,
                      success: function (response) {
                          //$('#flashMessage').html(response.message);
                          //$('#flashMessage').show();
                          //alert("success");
                          console.log(response);
                          
                          if(response.status == 200){
                            //updateSQLTable(response.response);
                              
                            console.log("success");
                          	window.location.href = "board(try).html?CourseId=1";
                      	
                          }
                      },
                      error: function () {
                          alert("無法連線到伺服器！");
                      }
              });
          }
  </script>

</body>
</html>
